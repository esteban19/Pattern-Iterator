C# implementation of Iterator pattern